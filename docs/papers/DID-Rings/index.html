<!DOCTYPE html>
<!DOCTYPE html><html lang="en" class="astro-COMNSPVE">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <title>Kyle Butts</title>
  <meta name="description" content="Academic site for Kyle Butts.">

  <!-- Katex for equations -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.0/dist/katex.min.css" cross-origin="anonymous">

  <!-- Tailwind CSS -->
  
<link rel="stylesheet" href="/assets/bb0aa130.3cc04c13.css" />
<link rel="stylesheet" href="/assets/55696eec.e49487f7.css" /></head>

<body>
  <!-- Dark Mode --><script src="">
  // Check for dark mode preference at the OS level
  const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");

  // Get the user's theme preference from local storage, if it's available
  let currentTheme = localStorage.getItem("theme");

  // Defaults
  if(currentTheme == null) {
    if(prefersDarkScheme.matches) {
      localStorage.setItem("theme", "dark")
      currentTheme = "dark"
    } else {
      localStorage.setItem("theme", "light")
      currentTheme = "light"
    }
  } 
  
  if (currentTheme == "dark") {
    document.body.classList.add("dark");
  } 
</script>


  <div class="min-h-screen w-full bg-mine-shaft-100 font-jetbrains text-mine-shaft-900 dark:bg-mine-shaft-900 dark:text-mine-shaft-50 astro-COMNSPVE">
    <div class="pt-size-xs prose:pt-size-sm-md pb-size-2xl astro-COMNSPVE">
      <div class="content   
  ">
  <nav class="flex w-full flex-row prose:flex-col justify-between gap-size-2xs pb-size-2xs border-b-[1px] border-mine-shaft-800 dark:border-mine-shaft-100">
  <h1 class="text-size-1 font-bold tracking-tight">
    <a href="/">Kyle Butts</a>
  </h1>
  <div class="flex prose:items-end justify-between">
    <style>astro-island,astro-slot{display:contents}</style><script>(self.Astro=self.Astro||{}).load=a=>{(async()=>await(await a())())()};var a;{const l={0:t=>t,1:t=>JSON.parse(t,o),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(JSON.parse(t,o)),5:t=>new Set(JSON.parse(t,o)),6:t=>BigInt(t),7:t=>new URL(t)},o=(t,s)=>{if(t===""||!Array.isArray(s))return s;const[e,i]=s;return e in l?l[e](i):void 0};customElements.get("astro-island")||customElements.define("astro-island",(a=class extends HTMLElement{constructor(){super(...arguments);this.hydrate=()=>{if(!this.hydrator||this.parentElement?.closest("astro-island[ssr]"))return;const s=this.querySelectorAll("astro-slot"),e={},i=this.querySelectorAll("template[data-astro-template]");for(const r of i)!r.closest(this.tagName)?.isSameNode(this)||(e[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove());for(const r of s)!r.closest(this.tagName)?.isSameNode(this)||(e[r.getAttribute("name")||"default"]=r.innerHTML);const n=this.hasAttribute("props")?JSON.parse(this.getAttribute("props"),o):{};this.hydrator(this)(this.Component,n,e,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),window.removeEventListener("astro:hydrate",this.hydrate),window.dispatchEvent(new CustomEvent("astro:hydrate"))}}async connectedCallback(){window.addEventListener("astro:hydrate",this.hydrate),await import(this.getAttribute("before-hydration-url"));const s=JSON.parse(this.getAttribute("opts"));Astro[this.getAttribute("client")](async()=>{const e=this.getAttribute("renderer-url"),[i,{default:n}]=await Promise.all([import(this.getAttribute("component-url")),e?import(e):()=>()=>{}]);return this.Component=i[this.getAttribute("component-export")||"default"],this.hydrator=n,this.hydrate},s,this)}attributeChangedCallback(){this.hydrator&&this.hydrate()}},a.observedAttributes=["props"],a))}</script><astro-island uid="vDIzs" component-url="/MenuItemsInline.caaf7c0d.js" component-export="default" renderer-url="/client.f71bfba5.js" props="{}" ssr="" client="load" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts="{&quot;name&quot;:&quot;MenuItemsInline&quot;,&quot;value&quot;:true}"><ul class="gap-x-size-xs-sm hidden prose:flex text-size-0 font-light"><li class="relative"><a href="/papers/">Papers</a></li><li class="relative"><a href="/open-source/">Open Source</a></li><li class="relative"><a href="/teaching/">Teaching</a></li><li class="relative"><a href="/blog/">Blog</a></li></ul></astro-island>
    <div class="flex items-center gap-size-3xs">
      <script>(self.Astro=self.Astro||{}).idle=a=>{const e=async()=>{await(await a())()};"requestIdleCallback"in window?window.requestIdleCallback(e):setTimeout(e,200)};</script><astro-island uid="Z8OkLW" component-url="/MenuItemsDropdown.bae11848.js" component-export="default" renderer-url="/client.f71bfba5.js" props="{}" ssr="" client="idle" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts="{&quot;name&quot;:&quot;MenuItemsDropdown&quot;,&quot;value&quot;:true}"><div class="relative z-10"><div class="flex items-center" id="headlessui-menu-button-:R1:" aria-haspopup="true" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 h-5 w-5 text-alice-500 dark:text-alice-400"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></div></div></astro-island>
      <astro-island uid="2h1W7H" component-url="/DarkModeButton.6fd08b36.js" component-export="default" renderer-url="/client.f71bfba5.js" props="{}" ssr="" client="idle" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts="{&quot;name&quot;:&quot;DarkModeButton&quot;,&quot;value&quot;:true}"><button aria-label="Dark Mode Toggle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="h-5 w-5 text-alice-500 dark:text-alice-400 cursor-pointer"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg></button></astro-island>
    </div>
  </div>
</nav>
</div>
        <div class="content   
  ">
  <h1 class="cursor-pointer tracking-tighter font-white dark:font-mine-shaft-900 text-size-1 font-bold">Difference-in-Differences with Geocoded Microdata</h1><p class="mt-size-3xs text-size-0 text-alice-400">R&R at <i>Journal of Urban Economics: Insights</i></p><div class="text-md mt-size-md flex flex-row flex-wrap gap-size-xs">
      <div>
        <p class="text-size-0">
          <a href="https://kylebutts.com" class="underline decoration-alice-500">
            Kyle Butts
          </a>
        </p>
      </div>
    </div><div class="text-md mt-size-md flex flex-row flex-wrap gap-size-xs">
      <div class="px-2 py-1 rounded-lg bg-alice-200 text-alice-900">
  <a href="https://arxiv.org/abs/2110.10192">ArXiv</a>
</div><div class="px-2 py-1 rounded-lg bg-alice-200 text-alice-900">
  <a href="../files/Rings_slides.pdf">Slides</a>
</div>
    </div>
</div><div class="mt-size-2xl"></div><div class="content flow prose 
  ">
  <h2 id="abstract">Abstract</h2><p>This paper formalizes a common approach for estimating effects of treatment at a specific location using geocoded microdata. This estimator compares units immediately next to treatment (an inner-ring) to units just slightly further away (an outer-ring). I introduce intuitive assumptions needed to identify the average treatment effect among the affected units and illustrates pitfalls that occur when these assumptions fail. Since one of these assumptions requires knowledge of exactly how far treatment effects are experienced, I propose a new method that relaxes this assumption and allows for nonparametric estimation using partitioning-based least squares developed in <a href="https://maxhfarrell.com/research/Cattaneo-Farrell-Feng2020_AoS.pdf">Cattaneo et. al. (2019)</a>. Since treatment effects typically decay/change over distance, this estimator improves analysis by estimating a treatment effect curve as a function of distance from treatment. This is contrast to the traditional method which, at best, identifies the average effect of treatment. To illustrate the advantages of this method, I show that <a href="https://www.aeaweb.org/articles?id=10.1257/aer.98.3.1103">Linden and Rockoff (2008)</a> under estimate the effects of increased crime risk on home values closest to the treatment and overestimate how far the effects extend by selecting a treatment ring that is too wide.</p><h2 id="5-minute-summary">5-Minute Summary</h2><p>The rise of geocoded microdata has allowed researchers to begin answering questions about the effects of spatially-targeted treatments at a very granular level. How do local pollutants affect child health? Does living within walking distance to a new bus stop improve labor market outcomes? How far do neighborhood shocks, such as foreclosures or new construction spread? A standard method of evaluating the effects of the treatment is to compare changes in outcomes for units that are close to treatment to those slightly further away â€“ what I label the <span class="dark:text-kelly-600 text-kelly-500">
  ring method
</span>.</p><p>The motivation for such a design is that since both the 'treated' and the 'control' units are within. the same local neighborhood, they should be subject to <span class="dark:text-coral-600 text-coral-500">
  common shocks
</span>. For example, <a href="https://dx.doi.org/10.1162/rest_a_01055">Asquith et al. (2021)</a> write <em>"The idea is that within a small area, developers have few sites that are available and properly zoned, leading to hyper-local variation in the location of new construction that is not related to future price changes."</em> I show in this paper that the currently proposed method does not <em>fully</em> use this <span class="dark:text-coral-600 text-coral-500">
  common shocks
</span> assumption and in turn (i) estimate results that are biased except under a very strong assumption and (ii) estimate an 'average effect' instead of the full treatment effect curve.</p><h3 id="problems-with-the-standard-ring-method">Problems with the standard ring method</h3><p>First, the problems with the standard ring method. In the below figure, I show 4 different "estimates" using the ring method for the same data-generating process. The black line highlights the treatment effect curve which declines over distance and becomes zero after <code>0.75 miles</code>. The gray line shows the counterfactual shock, which under the <span class="dark:text-coral-600 text-coral-500">
  common shocks
</span> is constant across distance and normalized to zero. For each estimate, the researcher compares the average change in outcomes in the <code>treated</code> section to the average change in outcomes in the <code>control</code> section, a difference-in-differences estimator.</p><div class="large-block not-prose wide-bleed max-w-[1480px] mx-auto relative
  group border-mine-shaft-600 bg-mine-shaft-50 dark:bg-mine-shaft-700
  dark:shadow-none dotted ">
  
  <figure>
  <div class="relative">
      <img src="/images/rings_ex.png" alt="Example of Problems with 'Standard' Rings method" class="mb-2 w-full">
    </div>
  <figcaption class="text-xl mt-8">
    <b>Figure:</b> Example of Problems with &#39;Standard&#39; Rings method
  </figcaption>
</figure>
</div><p>The top left panel, shows the 'oracle' estimator where the researcher knows how far treatment effects travel (<em>this is a very hard thing to justify and is usually an ad-hoc choice</em>). In this case, the researcher is able to correctly identify the <span class="dark:text-alice-600 text-alice-500">
  average treatment effect among the affected
</span>. Note, however, that this estimate masks over interesting heterogeneity in treatment effects over distance, with the closest units experiencing twice as large of a treatment effect as the average. Later on, I propose an estimator that estimates the average treatment effect as a function of distance.</p><p>It is not common, though, to know how far treatment effects travel. Hence, researchers typically will select the wrong distance. The problems arise are shown in the top-right and bottom-left panels. The top-right panel shows when the treatment ring is too wide. Since units experiencing no treatment effects are included in this sample, the average treatment effect is attenuated towards zero. The bottom-left panel shows when the the treatment ring is too narrow. In this case, the counterfactual trend estimated by the control unit is biased and hence the average effect is biased as well.</p><p>Researchers have recognized this problem and have proposed selecting alternate rings as 'robutsness checks'. The bottom-right panel shows the problem with this strategy. Consider using the bottom-left panel as your main specification and the bottom-right panel as your 'robustness check'. In both cases, you find the <em>same</em> treatment effect and neither of them are correct.</p><h3 id="non-parametric-rings-estimator">Non-parametric Rings Estimator</h3><p>The central idea behind my proposed estimator is instead of having a single treatment ring and a single control ring to have many rings. The furthest away ring will estimate the <span class="dark:text-coral-600 text-coral-500">
  common shock
</span> while the other rings will each estimate the treatment effect for that distance from treatment. For example, see the below figure which recreates the results of <a href="https://dx.doi.org/10.1257/aer.98.3.1103">Linden and Rockoff (2008)</a> who study the effects of a sexual offender arriving to your neighborhood on home prices. The top panel is the standard rings estimator. Notice they choose a cutoff and then assume the treatment effect is constant within the treated ring and that after their cutoff the effects are zero.</p><div class="large-block not-prose wide-bleed max-w-[1480px] mx-auto relative
  group border-mine-shaft-600 bg-mine-shaft-50 dark:bg-mine-shaft-700
  dark:shadow-none dotted ">
  
  <figure>
  <div class="relative">
      <img src="/images/linden_rockoff.png" alt="Linden and Rockoff (2008) Analysis of Sexual Offender Arrival on Home Prices" class="mb-2 w-full">
    </div>
  <figcaption class="text-xl mt-8">
    <b>Figure:</b> Linden and Rockoff (2008) Analysis of Sexual Offender Arrival on Home Prices
  </figcaption>
</figure>
</div><p>In contrast, the bottom panel performs the non-parametric rings estimator I propose in my paper. The figure more clearly shows that there are very large effects very close to the sexual offender's home and they decay to zero and then "treatment effect" estimates are centered at zero after <code>0.1 miles</code>. The results of my method (i) provide more interesting information on <em>heterogeneous</em> treatment effects while (ii) not requiring the correct specification of the treatment effect distance.</p><p>In my paper, I dive into the non-parametric method as originally proposed in <a href="http://arxiv.org/abs/1804.04916">Cattaneo et. al. (2019)</a> and prove my identification results, but there is one more important advantage to note in my estimator. The number and location of the rings is decided in a completely data-driven and optimal manner removing potential researcher degrees of freedom. Since the choice of treatment and control rings is typically done in an ad-hoc manner, my proposed estimator provides robustness against accidentally choosing rings that produce large results or rings that produce near-zero results.</p>
</div>
    </div>
  </div>
</body></html>