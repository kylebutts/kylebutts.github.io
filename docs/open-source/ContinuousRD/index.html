<!DOCTYPE html>
<!DOCTYPE html><html lang="en" class="astro-DLQHLW6P">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <title></title>

  <!-- Katex for equations -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.0/dist/katex.min.css" cross-origin="anonymous">

  <!-- Jetbrains Mono -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" cross-origin="true">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100;0,300;0,700;0,800;1,300" rel="stylesheet">

  <!-- Tailwind CSS -->
  
<link rel="stylesheet" href="/assets/bb0aa130.3cc04c13.css" />
<link rel="stylesheet" href="/assets/55696eec.7c493231.css" /></head>

<body>
  <!-- Dark Mode --><script src="">
  // Check for dark mode preference at the OS level
  const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");

  // Get the user's theme preference from local storage, if it's available
  let currentTheme = localStorage.getItem("theme");

  // Defaults
  if(currentTheme == null) {
    if(prefersDarkScheme.matches) {
      localStorage.setItem("theme", "dark")
      currentTheme = "dark"
    } else {
      localStorage.setItem("theme", "light")
      currentTheme = "light"
    }
  } 
  
  if (currentTheme == "dark") {
    document.body.classList.add("dark");
  } 
</script>


  <div class="min-h-screen w-full bg-mine-shaft-100 font-jetbrains text-mine-shaft-900 dark:bg-mine-shaft-900 dark:text-mine-shaft-50 astro-DLQHLW6P">
    <div class="pt-size-xs prose:pt-size-sm-md pb-size-2xl astro-DLQHLW6P">
      <div class="content   
  ">
  <nav class="flex w-full flex-row prose:flex-col justify-between gap-size-2xs pb-size-2xs border-b-[1px] border-mine-shaft-800 dark:border-mine-shaft-100">
  <h1 class="text-size-1 font-bold tracking-tight">
    <a href="/">Kyle Butts</a>
  </h1>
  <div class="flex prose:items-end justify-between">
    <style>astro-island,astro-slot{display:contents}</style><script>(self.Astro=self.Astro||{}).load=a=>{(async()=>await(await a())())()};var a;{const l={0:t=>t,1:t=>JSON.parse(t,o),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(JSON.parse(t,o)),5:t=>new Set(JSON.parse(t,o)),6:t=>BigInt(t),7:t=>new URL(t)},o=(t,s)=>{if(t===""||!Array.isArray(s))return s;const[e,i]=s;return e in l?l[e](i):void 0};customElements.get("astro-island")||customElements.define("astro-island",(a=class extends HTMLElement{constructor(){super(...arguments);this.hydrate=()=>{if(!this.hydrator||this.parentElement?.closest("astro-island[ssr]"))return;const s=this.querySelectorAll("astro-slot"),e={},i=this.querySelectorAll("template[data-astro-template]");for(const r of i)!r.closest(this.tagName)?.isSameNode(this)||(e[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove());for(const r of s)!r.closest(this.tagName)?.isSameNode(this)||(e[r.getAttribute("name")||"default"]=r.innerHTML);const n=this.hasAttribute("props")?JSON.parse(this.getAttribute("props"),o):{};this.hydrator(this)(this.Component,n,e,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),window.removeEventListener("astro:hydrate",this.hydrate),window.dispatchEvent(new CustomEvent("astro:hydrate"))}}async connectedCallback(){window.addEventListener("astro:hydrate",this.hydrate),await import(this.getAttribute("before-hydration-url"));const s=JSON.parse(this.getAttribute("opts"));Astro[this.getAttribute("client")](async()=>{const e=this.getAttribute("renderer-url"),[i,{default:n}]=await Promise.all([import(this.getAttribute("component-url")),e?import(e):()=>()=>{}]);return this.Component=i[this.getAttribute("component-export")||"default"],this.hydrator=n,this.hydrate},s,this)}attributeChangedCallback(){this.hydrator&&this.hydrate()}},a.observedAttributes=["props"],a))}</script><astro-island uid="vDIzs" component-url="/MenuItemsInline.caaf7c0d.js" component-export="default" renderer-url="/client.f71bfba5.js" props="{}" ssr="" client="load" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts="{&quot;name&quot;:&quot;MenuItemsInline&quot;,&quot;value&quot;:true}"><ul class="gap-x-size-xs-sm hidden prose:flex text-size-0 font-light"><li class="relative"><a href="/papers/">Papers</a></li><li class="relative"><a href="/open-source/">Open Source</a></li><li class="relative"><a href="/teaching/">Teaching</a></li><li class="relative"><a href="/blog/">Blog</a></li></ul></astro-island>
    <div class="flex items-center gap-size-3xs">
      <script>(self.Astro=self.Astro||{}).idle=a=>{const e=async()=>{await(await a())()};"requestIdleCallback"in window?window.requestIdleCallback(e):setTimeout(e,200)};</script><astro-island uid="Z8OkLW" component-url="/MenuItemsDropdown.bae11848.js" component-export="default" renderer-url="/client.f71bfba5.js" props="{}" ssr="" client="idle" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts="{&quot;name&quot;:&quot;MenuItemsDropdown&quot;,&quot;value&quot;:true}"><div class="relative z-10"><div class="flex items-center" id="headlessui-menu-button-:R1:" aria-haspopup="true" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 h-5 w-5 text-alice-500 dark:text-alice-400"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></div></div></astro-island>
      <astro-island uid="ZMGws" component-url="/DarkModeButton.5b405411.js" component-export="default" renderer-url="/client.f71bfba5.js" props="{}" ssr="" client="idle" before-hydration-url="data:text/javascript;charset=utf-8,//[no before-hydration script]" opts="{&quot;name&quot;:&quot;DarkModeButton&quot;,&quot;value&quot;:true}"><button><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="h-5 w-5 text-alice-500 dark:text-alice-400 cursor-pointer"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg></button></astro-island>
    </div>
  </div>
</nav>
</div>
        <div class="content flow prose 
  ">
  <h1 id="continuousrd"><a href="https://github.com/kylebutts/ContinuousRD">ContinuousRD</a></h1><p>ContinuousRD is a package that implements regression discontinuity
designs when the treatment variable is continuous following <a href="http://www.yingyingdong.com/Research/RD_ContinuousTreatment.pdf">Dong, Lee,
and Gou
(2022)</a></p><h2 id="installation">Installation</h2><p>You can install the development version of ContinuousRD from
<a href="https://github.com/">GitHub</a> with:</p><pre class="astro-code" style="background-color: #191724; overflow-x: auto;"><code><span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic"> install.packages(&quot;devtools&quot;)</span></span>
<span class="line"><span style="color: #E0DEF4">devtools</span><span style="color: #31748F">::</span><span style="color: #E0DEF4; font-style: italic">install_github</span><span style="color: #908CAA">(</span><span style="color: #F6C177">&quot;kylebutts/ContinuousRD&quot;</span><span style="color: #908CAA">)</span></span></code></pre><h2 id="setting">Setting</h2><p>I will provide a quick (and simplified) overview of the methods from
<a href="http://www.yingyingdong.com/Research/RD_ContinuousTreatment.pdf">Dong, Lee, and Gou
(2022)</a>.
For the full details, please see the original text. I’m purposefully
leaving out details since hopefully you are here <em>after</em> reading the
paper :-)</p><p>Let <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span> denote the outcome variable and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> a continuous variable of
interest. There exists a running variable <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span> and a cutoff <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span> (which
we’ll normalize to zero) that affects the treatment <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span>. The paper
assumes that different quantiles of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> are differentially affected by
the discontinuity.</p><p>For example, in the paper they discuss a minimum capital requirement for
banks in cities with population over 3,000 in 1900. The running variable
would be population and the treatment variable is banking capital.
Clearly, only banks with counterfactual banking capital below the
threshold are affected by the population cutoff. Therefore the jump in
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> will be zero for most banks, but positive for banks at the lower end
of the counterfactual distribution of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span>.</p><p>For this reason, the estimator proposed in the paper wants to estimate
the LATE at different quantiles of the distribution of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span>, which they
denote as the Quantile-LATE or QLATE for short. The method proceeds as
follows.</p><p>For a given quantile of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span>, denoted <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>∈</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">u \in (0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>, estimate the
“first-stage” RD of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span>. Define <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>q</mi><mo>+</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q^+(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span></span> be the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">u^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> percentile of
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> under treatment at <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">R = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>q</mi><mo>−</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q^-(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span></span> be the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">u^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> percentile
of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> under no treatment at <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">R = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>. The RD estimate of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> would
therefore estimate This will estimate
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">E</mi><mo stretchy="false">[</mo><msup><mi>q</mi><mo>+</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>−</mo><msup><mi>q</mi><mo>−</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi>U</mi><mo>=</mo><mi>u</mi><mo separator="true">,</mo><mi>R</mi><mo>=</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}[ q^+(u) - q^-(u) \vert U = u, R = 0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mord mathbb">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span>. Intuitively, this
gives the jump in the continuous treatment for units at the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">u^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span>
percentile of the distribution.</p><p>Then, the reduced form involves running an RD of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span> using observations
to the right of the cutoff with values of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> near <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_1(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span></span> and to the
left of the cutoff with values of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> near <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_0(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span></span>. The left and right
limits in the RD would respectively identify</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>m</mi><mo>−</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="double-struck">E</mi><mo stretchy="false">[</mo><mi>Y</mi><mi mathvariant="normal">∣</mi><mi>T</mi><mo>=</mo><msup><mi>q</mi><mo>−</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>R</mi><mo>=</mo><mn>0</mn><mo stretchy="false">]</mo><mtext> and </mtext><msup><mi>m</mi><mo>+</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="double-struck">E</mi><mo stretchy="false">[</mo><mi>Y</mi><mi mathvariant="normal">∣</mi><mi>T</mi><mo>=</mo><msup><mi>q</mi><mo>+</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>R</mi><mo>=</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">m^-(u) = \mathbb{E}[ Y | T = q^-(u), R = 0] \text{ and } m^+(u) = \mathbb{E}[ Y | T = q^+(u), R = 0] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0713em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">E</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0713em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0713em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">]</span><span class="mord text"><span class="mord"> and </span></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">E</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0713em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span></div><p>The difference between these two terms would estimate the jump in <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span>
for units near the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">u^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span> percentile of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span>. The QLATE estimate will
then be the ratio of these two quantities. Intuitively it’s the jump in
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span> rescaled by the jump in <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span>. Note that only quantiles that have a
significant jump <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>q</mi><mo>+</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>−</mo><msup><mi>q</mi><mo>−</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo mathvariant="normal">≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">q^+(u) - q^-(u) \neq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span> are used to form estimates
(since otherwise the denominator is 0).</p><img src="https://raw.githubusercontent.com/kylebutts/ContinuousRD/main/inst/example-identifcation.png" width="100%"><p>A visual example using a made-up DGP similar to the paper’s main example
is shown here for a given quantile <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">u = 0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.1</span></span></span></span></span>. The left-figure shows the
estimated jump in <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span>. The right-figure shows the estimated jump in <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span>
at value of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>q</mi><mo>−</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q^-(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>q</mi><mo>+</mo></msup><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q^+(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span></span>. The ratio of these two estimates
would be the estimated treatment effect and can be interpreted as the
jump in <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span> per unit increase in <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span>.</p><h2 id="example">Example</h2><p>I will use a set of simulated data as an illustration of the method</p><pre class="astro-code" style="background-color: #191724; overflow-x: auto;"><code><span class="line"><span style="color: #EB6F92; font-style: italic">library</span><span style="color: #E0DEF4">(</span><span style="color: #E0DEF4; font-style: italic">ContinuousRD</span><span style="color: #E0DEF4">)</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; Loading required package: data.table</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic"> Load data</span></span>
<span class="line"><span style="color: #EB6F92; font-style: italic">data</span><span style="color: #E0DEF4">(</span><span style="color: #E0DEF4; font-style: italic">sim_data</span><span style="color: #E0DEF4">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #EB6F92; font-style: italic">head</span><span style="color: #E0DEF4">(</span><span style="color: #E0DEF4; font-style: italic">sim_data</span><span style="color: #E0DEF4">)</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; Key: &lt;id&gt;</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt;       id         u           R     Z         T         Y</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt;    &lt;int&gt;     &lt;num&gt;       &lt;num&gt; &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; 1:     1 0.2002145 -0.71892650     0 0.6673815 0.6652777</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; 2:     2 0.6852186  0.19781138     1 1.3139139 1.3141626</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; 3:     3 0.9168758  0.03111523     1 1.4876568 1.4881608</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; 4:     4 0.2843995  0.64044390     1 1.0132996 1.0165819</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; 5:     5 0.1046501 -0.75736198     0 0.3488338 0.3474286</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; 6:     6 0.7010575  0.06593254     1 1.3257931 1.3291840</span></span></code></pre><p>The data consists of 10000 observations each of which is a unique unit.
The variable <code>Y</code> is the outcome variable, <code>T</code> is the continuous
treatment of interest, <code>R</code> is the running variable with a cutoff of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>.
Positive values of the running variable are affected by the border, in
this case a binding lower bound on <code>T</code>. The variable <code>u</code> is the
(typically unobserved) percentile of each unit for the variable <code>T</code>.</p><p>The below data shows the observed continuous treatment along the running
variable. The color of the dot represents the quantile of <code>T</code> at that
value of <code>R</code>. You can see a clear jump at the border where <code>T</code> is
affected by the binding constraint.</p><pre class="astro-code" style="background-color: #191724; overflow-x: auto;"><code><span class="line"><span style="color: #EB6F92; font-style: italic">library</span><span style="color: #E0DEF4">(</span><span style="color: #E0DEF4; font-style: italic">ggplot2</span><span style="color: #E0DEF4">)</span></span>
<span class="line"><span style="color: #E0DEF4; font-style: italic">ggplot</span><span style="color: #908CAA">(</span><span style="color: #E0DEF4; font-style: italic">sim_data</span><span style="color: #908CAA">)</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">+</span></span>
<span class="line"><span style="color: #E0DEF4">    </span><span style="color: #E0DEF4; font-style: italic">geom_point</span><span style="color: #908CAA">(</span></span>
<span class="line"><span style="color: #E0DEF4">        </span><span style="color: #E0DEF4; font-style: italic">aes</span><span style="color: #908CAA">(</span><span style="color: #C4A7E7; font-style: italic">x</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #E0DEF4; font-style: italic">R</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #C4A7E7; font-style: italic">y</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #E0DEF4; font-style: italic">T</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #C4A7E7; font-style: italic">color</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #E0DEF4; font-style: italic">u</span><span style="color: #908CAA">),</span></span>
<span class="line"><span style="color: #E0DEF4">        </span><span style="color: #C4A7E7; font-style: italic">alpha</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #EBBCBA">0.4</span></span>
<span class="line"><span style="color: #E0DEF4">    </span><span style="color: #908CAA">)</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">+</span><span style="color: #E0DEF4"> </span></span>
<span class="line"><span style="color: #E0DEF4">    </span><span style="color: #E0DEF4; font-style: italic">geom_vline</span><span style="color: #908CAA">(</span><span style="color: #C4A7E7; font-style: italic">xintercept</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #EBBCBA">0</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #C4A7E7; font-style: italic">color</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;red&quot;</span><span style="color: #908CAA">)</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">+</span></span>
<span class="line"><span style="color: #E0DEF4">    </span><span style="color: #E0DEF4; font-style: italic">labs</span><span style="color: #908CAA">(</span></span>
<span class="line"><span style="color: #E0DEF4">        </span><span style="color: #C4A7E7; font-style: italic">x</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;Running Variable&quot;</span><span style="color: #908CAA">,</span></span>
<span class="line"><span style="color: #E0DEF4">        </span><span style="color: #C4A7E7; font-style: italic">y</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;Continuous Treatment&quot;</span></span>
<span class="line"><span style="color: #E0DEF4">    </span><span style="color: #908CAA">)</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">+</span></span>
<span class="line"><span style="color: #E0DEF4">    </span><span style="color: #E0DEF4; font-style: italic">theme_minimal</span><span style="color: #908CAA">()</span></span></code></pre><img src="https://raw.githubusercontent.com/kylebutts/ContinuousRD/main/man/figures/README-plot-continuous-treatment-1.png" width="100%"><p>However, this is only binding for units at the lower end of the
distribution. To see this more clearly, let’s look at multiple RDs at
different quantiles of <code>T</code>.</p><pre class="astro-code" style="background-color: #191724; overflow-x: auto;"><code><span class="line"><span style="color: #EB6F92; font-style: italic">library</span><span style="color: #E0DEF4">(</span><span style="color: #E0DEF4; font-style: italic">rdrobust</span><span style="color: #E0DEF4">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C4A7E7; font-style: italic">low_q</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #E0DEF4; font-style: italic">sim_data</span><span style="color: #908CAA">[</span><span style="color: #E0DEF4; font-style: italic">sim_data</span><span style="color: #31748F">$</span><span style="color: #E0DEF4; font-style: italic">u</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">&gt;</span><span style="color: #E0DEF4"> </span><span style="color: #EBBCBA">0</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">&amp;</span><span style="color: #E0DEF4"> </span><span style="color: #E0DEF4; font-style: italic">sim_data</span><span style="color: #31748F">$</span><span style="color: #E0DEF4; font-style: italic">u</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">&lt;</span><span style="color: #E0DEF4"> </span><span style="color: #EBBCBA">0.2</span><span style="color: #E0DEF4">,</span><span style="color: #908CAA">]</span></span>
<span class="line"><span style="color: #C4A7E7; font-style: italic">high_q</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #E0DEF4; font-style: italic">sim_data</span><span style="color: #908CAA">[</span><span style="color: #E0DEF4; font-style: italic">sim_data</span><span style="color: #31748F">$</span><span style="color: #E0DEF4; font-style: italic">u</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">&gt;</span><span style="color: #E0DEF4"> </span><span style="color: #EBBCBA">0.5</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">&amp;</span><span style="color: #E0DEF4"> </span><span style="color: #E0DEF4; font-style: italic">sim_data</span><span style="color: #31748F">$</span><span style="color: #E0DEF4; font-style: italic">R</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">&lt;</span><span style="color: #E0DEF4"> </span><span style="color: #EBBCBA">0.7</span><span style="color: #E0DEF4">,</span><span style="color: #908CAA">]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E0DEF4">rdrobust</span><span style="color: #31748F">::</span><span style="color: #E0DEF4; font-style: italic">rdplot</span><span style="color: #908CAA">(</span></span>
<span class="line"><span style="color: #E0DEF4">    </span><span style="color: #C4A7E7; font-style: italic">y</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #E0DEF4; font-style: italic">low_q</span><span style="color: #31748F">$</span><span style="color: #E0DEF4; font-style: italic">T</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #C4A7E7; font-style: italic">x</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #E0DEF4; font-style: italic">low_q</span><span style="color: #31748F">$</span><span style="color: #E0DEF4; font-style: italic">R</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span></span>
<span class="line"><span style="color: #E0DEF4">    </span><span style="color: #C4A7E7; font-style: italic">title</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;Low quantile of T&quot;</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #C4A7E7; font-style: italic">y.label</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;Continuous Treatment&quot;</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #C4A7E7; font-style: italic">x.label</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;Running Variable&quot;</span></span>
<span class="line"><span style="color: #908CAA">)</span></span></code></pre><img src="https://raw.githubusercontent.com/kylebutts/ContinuousRD/main/man/figures/README-quatnile-RDs-1.png" width="100%"><pre class="astro-code" style="background-color: #191724; overflow-x: auto;"><code><span class="line"><span style="color: #E0DEF4">rdrobust</span><span style="color: #31748F">::</span><span style="color: #E0DEF4; font-style: italic">rdplot</span><span style="color: #908CAA">(</span></span>
<span class="line"><span style="color: #E0DEF4">    </span><span style="color: #C4A7E7; font-style: italic">y</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #E0DEF4; font-style: italic">high_q</span><span style="color: #31748F">$</span><span style="color: #E0DEF4; font-style: italic">T</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #C4A7E7; font-style: italic">x</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #E0DEF4; font-style: italic">high_q</span><span style="color: #31748F">$</span><span style="color: #E0DEF4; font-style: italic">R</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span></span>
<span class="line"><span style="color: #E0DEF4">    </span><span style="color: #C4A7E7; font-style: italic">title</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;High quantile of T&quot;</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #C4A7E7; font-style: italic">y.label</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;Continuous Treatment&quot;</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #C4A7E7; font-style: italic">x.label</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;Running Variable&quot;</span></span>
<span class="line"><span style="color: #908CAA">)</span></span></code></pre><img src="https://raw.githubusercontent.com/kylebutts/ContinuousRD/main/man/figures/README-quatnile-RDs-2.png" width="100%"><p>The data is simulated to have units with quantile below <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.3</mn></mrow><annotation encoding="application/x-tex">0.3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.3</span></span></span></span></span> be
affected by the cutoff (the magnitude of the change in <code>T</code> depends on
quantile <code>u</code>) and those units experience a treatment effect of size <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>.
Let’s see if we get that using the <code>QLATE_bc_se</code> function:</p><pre class="astro-code" style="background-color: #191724; overflow-x: auto;"><code><span class="line"><span style="color: #E0DEF4; font-style: italic">res</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">&lt;-</span><span style="color: #E0DEF4"> ContinuousRD</span><span style="color: #31748F">::</span><span style="color: #E0DEF4; font-style: italic">QLATE_bc_se</span><span style="color: #908CAA">(</span><span style="color: #E0DEF4; font-style: italic">sim_data</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #C4A7E7; font-style: italic">qlist</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #EB6F92; font-style: italic">seq</span><span style="color: #E0DEF4">(</span><span style="color: #EBBCBA">0.1</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #EBBCBA">0.9</span><span style="color: #908CAA">,</span><span style="color: #E0DEF4"> </span><span style="color: #C4A7E7; font-style: italic">by</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #EBBCBA">0.1</span><span style="color: #908CAA">)</span><span style="color: #E0DEF4">, </span><span style="color: #C4A7E7; font-style: italic">yname</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;Y&quot;</span><span style="color: #E0DEF4">, </span><span style="color: #C4A7E7; font-style: italic">tname</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;T&quot;</span><span style="color: #E0DEF4">, </span><span style="color: #C4A7E7; font-style: italic">rname</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #F6C177">&quot;R&quot;</span><span style="color: #E0DEF4">, </span><span style="color: #C4A7E7; font-style: italic">c</span><span style="color: #E0DEF4"> </span><span style="color: #31748F">=</span><span style="color: #E0DEF4"> </span><span style="color: #EBBCBA">0</span><span style="color: #E0DEF4">)</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; `qlist`: 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, and 0.9</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; `tau_u`: 1, 1.001, NA, NA, NA, NA, NA, NA, and NA</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; `SEtau`: 0.005, 0.018, NA, NA, NA, NA, NA, NA, and NA</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; `tau_u_bc`: 0.992, 0.985, NA, NA, NA, NA, NA, NA, and NA</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; `SEtau_bc`: 2.384, 7.942, NA, NA, NA, NA, NA, NA, and NA</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; `pi`: 1.001</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; `SEpi`: 0.004</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; `pi_bc`: 0.991</span></span>
<span class="line"><span style="color: #908CAA; font-style: italic">#</span><span style="color: #6E6A86; font-style: italic">&gt; `SEpi_bc`: 0.359</span></span></code></pre><p>In the printed results a value of <code>NA</code> appears when no significant jump
in the treatment variable is found at the cutoff. In this case, since
the jump around the 30th percentile is near zero, it doesn’t show up in
the estimate. However, we see there the effect is around <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span> as expected
for the 10th and 20th percentile. The overall average effect <code>pi</code> is
also approximately <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span> as well.</p>
</div>
    </div>
  </div>
</body></html>